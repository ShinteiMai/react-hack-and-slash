{"ast":null,"code":"import _regeneratorRuntime from\"/home/shinteimai/workspace/personal/react-pokedex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/shinteimai/workspace/personal/react-pokedex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/shinteimai/workspace/personal/react-pokedex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/shinteimai/workspace/personal/react-pokedex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{createSlice}from\"@reduxjs/toolkit\";import fromApi from\"../api/fromApi\";import{SliceStatus}from\"../globals\";import{statusHandlerReducer,wrapReduxAsyncHandler}from\"./utilities\";import Levenshtein from\"fast-levenshtein\";export var PokemonGenerationsEnum;(function(PokemonGenerationsEnum){PokemonGenerationsEnum[\"GENERATION_1\"]=\"151\";PokemonGenerationsEnum[\"GENERATION_2\"]=\"251\";PokemonGenerationsEnum[\"GENERATION_3\"]=\"386\";PokemonGenerationsEnum[\"GENERATION_4\"]=\"494\";PokemonGenerationsEnum[\"GENERATION_5\"]=\"649\";PokemonGenerationsEnum[\"GENERATION_6\"]=\"721\";PokemonGenerationsEnum[\"GENERATION_7\"]=\"809\";})(PokemonGenerationsEnum||(PokemonGenerationsEnum={}));var initialState={cache:[],data:[],status:{state:SliceStatus.IDLE}};var cachedPokemonsSlice=createSlice({name:\"cachedPokemons\",initialState:initialState,reducers:_objectSpread({},statusHandlerReducer,{getCachedPokemonsReducer:function getCachedPokemonsReducer(state,action){var cachedPokemons=action.payload.cachedPokemons;var transformedCache=cachedPokemons.map(function(pokemon){return _objectSpread({},pokemon,{distance:0});});state.cache=transformedCache;state.data=transformedCache;},searchPokemonsByNameReducer:function searchPokemonsByNameReducer(state,action){var pokemonName=action.payload.pokemonName;state.data=state.data.map(function(pokemon){return _objectSpread({},pokemon,{distance:Levenshtein.get(pokemon.name,pokemonName)});}).sort(function(a,b){return a.distance-b.distance;});},filterPokemonsByGenerationReducer:function filterPokemonsByGenerationReducer(state,action){var selectedGeneration=action.payload.selectedGeneration;var cache=state.cache;if(selectedGeneration){var generations=Object.entries(PokemonGenerationsEnum);var startingIndex=0;generations.forEach(function(_ref,index){var _ref2=_slicedToArray(_ref,2),_=_ref2[0],b=_ref2[1];if(b===selectedGeneration){startingIndex=index===0?0:Number(generations[index-1][1]);}});cache=state.cache.slice(startingIndex,Number(selectedGeneration));}state.data=cache;}})});export var cachedPokemonsReducer=cachedPokemonsSlice.reducer;var _cachedPokemonsSlice$=cachedPokemonsSlice.actions,initialize=_cachedPokemonsSlice$.initialize,error=_cachedPokemonsSlice$.error,success=_cachedPokemonsSlice$.success,getCachedPokemonsReducer=_cachedPokemonsSlice$.getCachedPokemonsReducer,searchPokemonsByNameReducer=_cachedPokemonsSlice$.searchPokemonsByNameReducer,filterPokemonsByGenerationReducer=_cachedPokemonsSlice$.filterPokemonsByGenerationReducer;export{initialize,error,success,getCachedPokemonsReducer,searchPokemonsByNameReducer,filterPokemonsByGenerationReducer};var statusHandler={initialize:initialize,error:error,success:success};export var cachedPokemonsSelector=function cachedPokemonsSelector(state){return state.cachedPokemons;};export var getCachedPokemons=wrapReduxAsyncHandler(statusHandler,/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var _yield$fromApi$getPok,results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fromApi.getPokemons(Number(PokemonGenerationsEnum.GENERATION_7));case 2:_yield$fromApi$getPok=_context.sent;results=_yield$fromApi$getPok.results;dispatch(getCachedPokemonsReducer({cachedPokemons:results}));case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref3.apply(this,arguments);};}());","map":{"version":3,"sources":["/home/shinteimai/workspace/personal/react-pokedex/src/features/cachedPokemonsSlice.ts"],"names":["createSlice","fromApi","SliceStatus","statusHandlerReducer","wrapReduxAsyncHandler","Levenshtein","PokemonGenerationsEnum","initialState","cache","data","status","state","IDLE","cachedPokemonsSlice","name","reducers","getCachedPokemonsReducer","action","cachedPokemons","payload","transformedCache","map","pokemon","distance","searchPokemonsByNameReducer","pokemonName","get","sort","a","b","filterPokemonsByGenerationReducer","selectedGeneration","generations","Object","entries","startingIndex","forEach","index","_","Number","slice","cachedPokemonsReducer","reducer","actions","initialize","error","success","statusHandler","cachedPokemonsSelector","getCachedPokemons","dispatch","getPokemons","GENERATION_7","results"],"mappings":"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","sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport fromApi from \"../api/fromApi\";\nimport { SliceStatus } from \"../globals\";\nimport { RootState } from \"./store\";\nimport { NamedAPIResource } from \"./types\";\nimport { statusHandlerReducer, wrapReduxAsyncHandler } from \"./utilities\";\nimport Levenshtein from \"fast-levenshtein\";\n\nexport enum PokemonGenerationsEnum {\n  GENERATION_1 = \"151\",\n  GENERATION_2 = \"251\",\n  GENERATION_3 = \"386\",\n  GENERATION_4 = \"494\",\n  GENERATION_5 = \"649\",\n  GENERATION_6 = \"721\",\n  GENERATION_7 = \"809\",\n}\n\ntype SliceState = {\n  cache: (NamedAPIResource & { distance: number })[];\n  data: (NamedAPIResource & { distance: number })[];\n  status: {\n    state: SliceStatus;\n  };\n};\n\nconst initialState: SliceState = {\n  cache: [],\n  data: [],\n  status: {\n    state: SliceStatus.IDLE,\n  },\n};\n\nconst cachedPokemonsSlice = createSlice({\n  name: \"cachedPokemons\",\n  initialState,\n  reducers: {\n    ...statusHandlerReducer,\n    getCachedPokemonsReducer(\n      state,\n      action: PayloadAction<{ cachedPokemons: NamedAPIResource[] }>\n    ) {\n      const { cachedPokemons } = action.payload;\n      const transformedCache = cachedPokemons.map((pokemon) => {\n        return {\n          ...pokemon,\n          distance: 0,\n        };\n      });\n      state.cache = transformedCache;\n      state.data = transformedCache;\n    },\n    searchPokemonsByNameReducer(\n      state,\n      action: PayloadAction<{\n        pokemonName: string;\n      }>\n    ) {\n      const { pokemonName } = action.payload;\n\n      state.data = state.data\n        .map((pokemon) => {\n          return {\n            ...pokemon,\n            distance: Levenshtein.get(pokemon.name, pokemonName),\n          };\n        })\n        .sort((a, b) => a.distance - b.distance);\n    },\n    filterPokemonsByGenerationReducer(\n      state,\n      action: PayloadAction<{\n        selectedGeneration: PokemonGenerationsEnum | null;\n      }>\n    ) {\n      const { selectedGeneration } = action.payload;\n      let cache: (NamedAPIResource & { distance: number })[] = state.cache;\n\n      if (selectedGeneration) {\n        const generations = Object.entries(PokemonGenerationsEnum);\n        let startingIndex: number = 0;\n        generations.forEach(([_, b], index) => {\n          if (b === selectedGeneration) {\n            startingIndex = index === 0 ? 0 : Number(generations[index - 1][1]);\n          }\n        });\n        cache = state.cache.slice(startingIndex, Number(selectedGeneration));\n      }\n\n      state.data = cache;\n    },\n  },\n});\n\nexport const cachedPokemonsReducer = cachedPokemonsSlice.reducer;\nexport const {\n  initialize,\n  error,\n  success,\n  getCachedPokemonsReducer,\n  searchPokemonsByNameReducer,\n  filterPokemonsByGenerationReducer,\n} = cachedPokemonsSlice.actions;\n\nconst statusHandler = { initialize, error, success };\n\nexport const cachedPokemonsSelector = (state: RootState) =>\n  state.cachedPokemons;\n\nexport const getCachedPokemons = wrapReduxAsyncHandler(\n  statusHandler,\n  async (dispatch) => {\n    const {\n      results,\n    }: { results: NamedAPIResource[] } = await fromApi.getPokemons(\n      Number(PokemonGenerationsEnum.GENERATION_7)\n    );\n    dispatch(getCachedPokemonsReducer({ cachedPokemons: results }));\n  }\n);\n"]},"metadata":{},"sourceType":"module"}