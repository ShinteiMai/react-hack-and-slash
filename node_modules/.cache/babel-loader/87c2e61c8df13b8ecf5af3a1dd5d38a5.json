{"ast":null,"code":"var _jsxFileName = \"/home/shinteimai/workspace/personal/react-pokedex/src/pages/PokemonDetailsPage.tsx\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport Layout from \"../components/Layout\";\nimport PokemonDetailsBiography from \"../components/PokemonDetailsBiography\";\nimport PokemonDetailsEvolutions from \"../components/PokemonDetailsEvolutions\";\nimport PokemonDetailsHeader from \"../components/PokemonDetailsHeader\";\nimport PokemonDetailsStats from \"../components/PokemonDetailsStats\";\nimport Tab from \"../components/Tab\";\nimport { getPokemonById, pokemonsSelector } from \"../features/pokemonSlice\";\nimport { getSpeciesById, speciesSelector } from \"../features/speciesSlice\";\nimport { PokemonTypeColors, SliceStatus } from \"../globals\";\nimport { ScaleLoader } from \"react-spinners\";\nimport { useTransition, animated } from \"react-spring\";\nimport { capitalize } from \"../utils/capitalize\";\nimport { evolutionChainSelector, getEvolutionChainById } from \"../features/evolutionChainSlice\";\n\nconst PokemonDetailsPage = ({\n  match\n}) => {\n  var _selectedSpecies$evol;\n\n  const {\n    id\n  } = match.params;\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [activeTab, setActiveTab] = useState(\"evolutions\");\n  const transitions = useTransition(activeTab, p => p, {\n    from: {\n      opacity: 0\n    },\n    enter: {\n      opacity: 1\n    },\n    leave: {\n      opacity: 0\n    },\n    config: {\n      duration: 250\n    }\n  });\n  const pokemons = useSelector(pokemonsSelector);\n  const species = useSelector(speciesSelector);\n  const evolutionChain = useSelector(evolutionChainSelector);\n  const [chainLinks, setChainLinks] = useState([]);\n  const [selectedEvolutionPokemonIds, setSelectedEvolutionPokemonIds] = useState([]);\n  const selectedPokemon = pokemons.data.find(pokemon => pokemon !== null && pokemon.id === Number(id));\n  const selectedSpecies = species.data.find(s => s.id === Number(id));\n  const evolutionChainId = (selectedSpecies === null || selectedSpecies === void 0 ? void 0 : (_selectedSpecies$evol = selectedSpecies.evolutionChain) === null || _selectedSpecies$evol === void 0 ? void 0 : _selectedSpecies$evol.url.split(\"/\").slice(-2)[0]) || null;\n  const selectedEvolutionChain = evolutionChainId !== null ? evolutionChain.data.find(e => e.id === Number(evolutionChainId)) : null;\n  const getPokemonEvolution = useCallback(chain => {\n    if (!chain) {\n      return [];\n    } else {\n      return [chain].concat(getPokemonEvolution(chain.evolvesTo[0]));\n    }\n  }, []);\n  useEffect(() => {\n    if (selectedEvolutionChain === null || selectedEvolutionChain === void 0 ? void 0 : selectedEvolutionChain.chain) {\n      const pokemons = getPokemonEvolution(selectedEvolutionChain.chain);\n      console.log(selectedEvolutionChain);\n      const pokemonIds = pokemons.map(({\n        species\n      }) => Number(species.url.split(\"/\").slice(-2)[0]));\n\n      for (const pokemonId of pokemonIds) {\n        dispatch(getPokemonById({\n          pokemonId\n        }));\n      }\n\n      setSelectedEvolutionPokemonIds(pokemonIds);\n      setChainLinks(pokemons);\n    } //eslint-disable-next-line\n\n  }, [selectedEvolutionChain]);\n  useEffect(() => {\n    if (pokemons.data.length === 0) {\n      dispatch(getPokemonById({\n        pokemonId: id\n      }));\n    }\n\n    dispatch(getSpeciesById({\n      pokemonId: id\n    })); //eslint-disable-next-line\n  }, [id, pokemons.data.length]);\n  useEffect(() => {\n    if (evolutionChainId) {\n      dispatch(getEvolutionChainById({\n        id: Number(evolutionChainId)\n      }));\n    } //eslint-disable-next-line\n\n  }, [selectedPokemon, evolutionChainId]);\n  const backgroundColors = selectedPokemon === null || selectedPokemon === void 0 ? void 0 : selectedPokemon.types.map(({\n    type\n  }) => {\n    const [[, backgroundColor]] = Object.entries(PokemonTypeColors).filter(([key, _]) => key === type.name);\n    return backgroundColor;\n  });\n  const selectedBackgroundColor = backgroundColors && backgroundColors[0];\n  const isPageLoading = species.status.state === SliceStatus.IDLE || species.status.state === SliceStatus.LOADING || evolutionChain.status.state === SliceStatus.IDLE || evolutionChain.status.state === SliceStatus.LOADING;\n  return /*#__PURE__*/React.createElement(Layout, {\n    title: capitalize(selectedPokemon === null || selectedPokemon === void 0 ? void 0 : selectedPokemon.name),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, isPageLoading ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-center mx-auto mt-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ScaleLoader, {\n    color: \"#E3350D\",\n    radius: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  })) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(React.Fragment, null, selectedPokemon && selectedSpecies && selectedBackgroundColor && selectedEvolutionChain && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pb-8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"text-primary font-semibold transform hover:-translate-y-1 transition-transform ease-in duration-150 focus:outline-none\",\n    onClick: () => history.push(\"/\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-primary font-semibold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  }, \"Go Back\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col lg:flex-row justify-center items-start w-full mx-auto my-4 rounded-lg shadow-lg\",\n    style: {\n      backgroundColor: selectedBackgroundColor && selectedBackgroundColor.medium\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(PokemonDetailsHeader, {\n    pokemon: selectedPokemon,\n    species: selectedSpecies,\n    selectedBackgroundColor: selectedBackgroundColor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-white lg:mt-0 rounded-t-3xl rounded-b-lg lg:rounded-t-none lg:rounded-b-none lg:rounded-r-lg overflow-hidden w-full pt-16 lg:pt-8 px-6 md:px-12 lg:px-24\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-row justify-between w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Tab, {\n    handleSelect: () => setActiveTab(\"biography\"),\n    isSelected: activeTab === \"biography\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }, \"Biography\"), /*#__PURE__*/React.createElement(Tab, {\n    handleSelect: () => setActiveTab(\"stats\"),\n    isSelected: activeTab === \"stats\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 25\n    }\n  }, \"Stats\"), /*#__PURE__*/React.createElement(Tab, {\n    handleSelect: () => setActiveTab(\"evolutions\"),\n    isSelected: activeTab === \"evolutions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 25\n    }\n  }, \"Evolutions\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"relative mt-8 lg:h-178\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 23\n    }\n  }, transitions.map(({\n    item,\n    key,\n    props\n  }) => {\n    let page = /*#__PURE__*/React.createElement(PokemonDetailsBiography, {\n      species: selectedSpecies,\n      pokemon: selectedPokemon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 29\n      }\n    });\n\n    switch (item) {\n      case \"biography\":\n        page = /*#__PURE__*/React.createElement(PokemonDetailsBiography, {\n          species: selectedSpecies,\n          pokemon: selectedPokemon,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 33\n          }\n        });\n        break;\n\n      case \"stats\":\n        page = /*#__PURE__*/React.createElement(PokemonDetailsStats, {\n          pokemon: selectedPokemon,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 33\n          }\n        });\n        break;\n\n      case \"evolutions\":\n        page = /*#__PURE__*/React.createElement(PokemonDetailsEvolutions, {\n          selectedIds: selectedEvolutionPokemonIds,\n          chainLinks: chainLinks,\n          selectedBackgroundColor: selectedBackgroundColor,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 33\n          }\n        });\n        break;\n\n      default:\n        break;\n    }\n\n    return /*#__PURE__*/React.createElement(animated.div, {\n      key: key,\n      style: { ...props,\n        position: \"relative\",\n        width: \"100%\",\n        height: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 29\n      }\n    }, page);\n  }))))))));\n};\n\nexport default PokemonDetailsPage;","map":{"version":3,"sources":["/home/shinteimai/workspace/personal/react-pokedex/src/pages/PokemonDetailsPage.tsx"],"names":["React","useCallback","useEffect","useState","useDispatch","useSelector","useHistory","Layout","PokemonDetailsBiography","PokemonDetailsEvolutions","PokemonDetailsHeader","PokemonDetailsStats","Tab","getPokemonById","pokemonsSelector","getSpeciesById","speciesSelector","PokemonTypeColors","SliceStatus","ScaleLoader","useTransition","animated","capitalize","evolutionChainSelector","getEvolutionChainById","PokemonDetailsPage","match","id","params","dispatch","history","activeTab","setActiveTab","transitions","p","from","opacity","enter","leave","config","duration","pokemons","species","evolutionChain","chainLinks","setChainLinks","selectedEvolutionPokemonIds","setSelectedEvolutionPokemonIds","selectedPokemon","data","find","pokemon","Number","selectedSpecies","s","evolutionChainId","url","split","slice","selectedEvolutionChain","e","getPokemonEvolution","chain","concat","evolvesTo","console","log","pokemonIds","map","pokemonId","length","backgroundColors","types","type","backgroundColor","Object","entries","filter","key","_","name","selectedBackgroundColor","isPageLoading","status","state","IDLE","LOADING","push","medium","item","props","page","position","width","height"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { RouteComponentProps } from \"react-router\";\nimport Layout from \"../components/Layout\";\nimport PokemonDetailsBiography from \"../components/PokemonDetailsBiography\";\nimport PokemonDetailsEvolutions from \"../components/PokemonDetailsEvolutions\";\nimport PokemonDetailsHeader from \"../components/PokemonDetailsHeader\";\nimport PokemonDetailsStats from \"../components/PokemonDetailsStats\";\nimport Tab from \"../components/Tab\";\nimport { getPokemonById, pokemonsSelector } from \"../features/pokemonSlice\";\nimport { getSpeciesById, speciesSelector } from \"../features/speciesSlice\";\nimport { PokemonTypeColors, SliceStatus } from \"../globals\";\nimport { ScaleLoader } from \"react-spinners\";\nimport { useTransition, animated } from \"react-spring\";\nimport { capitalize } from \"../utils/capitalize\";\nimport {\n  ChainLink,\n  evolutionChainSelector,\n  getEvolutionChainById,\n} from \"../features/evolutionChainSlice\";\n\ntype PokemonTabs = \"biography\" | \"stats\" | \"evolutions\";\n\ninterface MatchParams {\n  id: string;\n}\n\nconst PokemonDetailsPage = ({ match }: RouteComponentProps<MatchParams>) => {\n  const { id } = match.params;\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [activeTab, setActiveTab] = useState<PokemonTabs>(\"evolutions\");\n  const transitions = useTransition(activeTab, (p) => p, {\n    from: { opacity: 0 },\n    enter: { opacity: 1 },\n    leave: { opacity: 0 },\n    config: {\n      duration: 250,\n    },\n  });\n\n  const pokemons = useSelector(pokemonsSelector);\n  const species = useSelector(speciesSelector);\n  const evolutionChain = useSelector(evolutionChainSelector);\n  const [chainLinks, setChainLinks] = useState<ChainLink[]>([]);\n  const [\n    selectedEvolutionPokemonIds,\n    setSelectedEvolutionPokemonIds,\n  ] = useState<number[]>([]);\n\n  const selectedPokemon = pokemons.data.find(\n    (pokemon) => pokemon !== null && pokemon.id === Number(id)\n  );\n  const selectedSpecies = species.data.find((s) => s.id === Number(id));\n  const evolutionChainId =\n    selectedSpecies?.evolutionChain?.url.split(\"/\").slice(-2)[0] || null;\n  const selectedEvolutionChain =\n    evolutionChainId !== null\n      ? evolutionChain.data.find((e) => e.id === Number(evolutionChainId))\n      : null;\n\n  const getPokemonEvolution = useCallback(\n    (chain: ChainLink | null): ChainLink[] => {\n      if (!chain) {\n        return [];\n      } else {\n        return [chain].concat(getPokemonEvolution(chain.evolvesTo[0]));\n      }\n    },\n    []\n  );\n\n  useEffect(() => {\n    if (selectedEvolutionChain?.chain) {\n      const pokemons: ChainLink[] = getPokemonEvolution(\n        selectedEvolutionChain.chain\n      );\n      console.log(selectedEvolutionChain);\n      const pokemonIds = pokemons.map(({ species }) =>\n        Number(species.url.split(\"/\").slice(-2)[0])\n      );\n      for (const pokemonId of pokemonIds) {\n        dispatch(getPokemonById({ pokemonId }));\n      }\n      setSelectedEvolutionPokemonIds(pokemonIds);\n      setChainLinks(pokemons);\n    }\n    //eslint-disable-next-line\n  }, [selectedEvolutionChain]);\n\n  useEffect(() => {\n    if (pokemons.data.length === 0) {\n      dispatch(getPokemonById({ pokemonId: id }));\n    }\n    dispatch(getSpeciesById({ pokemonId: id }));\n    //eslint-disable-next-line\n  }, [id, pokemons.data.length]);\n\n  useEffect(() => {\n    if (evolutionChainId) {\n      dispatch(getEvolutionChainById({ id: Number(evolutionChainId) }));\n    }\n    //eslint-disable-next-line\n  }, [selectedPokemon, evolutionChainId]);\n\n  const backgroundColors = selectedPokemon?.types.map(({ type }) => {\n    const [[, backgroundColor]] = Object.entries(PokemonTypeColors).filter(\n      ([key, _]) => key === type.name\n    );\n\n    return backgroundColor;\n  });\n\n  const selectedBackgroundColor = backgroundColors && backgroundColors[0];\n\n  const isPageLoading =\n    species.status.state === SliceStatus.IDLE ||\n    species.status.state === SliceStatus.LOADING ||\n    evolutionChain.status.state === SliceStatus.IDLE ||\n    evolutionChain.status.state === SliceStatus.LOADING;\n\n  return (\n    <Layout title={capitalize(selectedPokemon?.name)}>\n      {isPageLoading ? (\n        <div className=\"text-center mx-auto mt-12\">\n          <ScaleLoader color=\"#E3350D\" radius={16} />\n        </div>\n      ) : (\n        <>\n          <>\n            {selectedPokemon &&\n              selectedSpecies &&\n              selectedBackgroundColor &&\n              selectedEvolutionChain && (\n                <div className=\"pb-8\">\n                  <button\n                    className=\"text-primary font-semibold transform hover:-translate-y-1 transition-transform ease-in duration-150 focus:outline-none\"\n                    onClick={() => history.push(\"/\")}\n                  >\n                    <span className=\"text-primary font-semibold\">Go Back</span>\n                  </button>\n                  <div\n                    className=\"flex flex-col lg:flex-row justify-center items-start w-full mx-auto my-4 rounded-lg shadow-lg\"\n                    style={{\n                      backgroundColor:\n                        selectedBackgroundColor &&\n                        selectedBackgroundColor.medium,\n                    }}\n                  >\n                    <PokemonDetailsHeader\n                      pokemon={selectedPokemon}\n                      species={selectedSpecies}\n                      selectedBackgroundColor={selectedBackgroundColor}\n                    />\n                    <div className=\"bg-white lg:mt-0 rounded-t-3xl rounded-b-lg lg:rounded-t-none lg:rounded-b-none lg:rounded-r-lg overflow-hidden w-full pt-16 lg:pt-8 px-6 md:px-12 lg:px-24\">\n                      <div className=\"flex flex-row justify-between w-full\">\n                        <Tab\n                          handleSelect={() => setActiveTab(\"biography\")}\n                          isSelected={activeTab === \"biography\"}\n                        >\n                          Biography\n                        </Tab>\n                        <Tab\n                          handleSelect={() => setActiveTab(\"stats\")}\n                          isSelected={activeTab === \"stats\"}\n                        >\n                          Stats\n                        </Tab>\n                        <Tab\n                          handleSelect={() => setActiveTab(\"evolutions\")}\n                          isSelected={activeTab === \"evolutions\"}\n                        >\n                          Evolutions\n                        </Tab>\n                      </div>\n                      <div className=\"relative mt-8 lg:h-178\">\n                        {transitions.map(({ item, key, props }) => {\n                          let page: JSX.Element = (\n                            <PokemonDetailsBiography\n                              species={selectedSpecies}\n                              pokemon={selectedPokemon}\n                            />\n                          );\n\n                          switch (item) {\n                            case \"biography\":\n                              page = (\n                                <PokemonDetailsBiography\n                                  species={selectedSpecies}\n                                  pokemon={selectedPokemon}\n                                />\n                              );\n                              break;\n                            case \"stats\":\n                              page = (\n                                <PokemonDetailsStats\n                                  pokemon={selectedPokemon}\n                                />\n                              );\n                              break;\n                            case \"evolutions\":\n                              page = (\n                                <PokemonDetailsEvolutions\n                                  selectedIds={selectedEvolutionPokemonIds}\n                                  chainLinks={chainLinks}\n                                  selectedBackgroundColor={\n                                    selectedBackgroundColor\n                                  }\n                                />\n                              );\n                              break;\n                            default:\n                              break;\n                          }\n                          return (\n                            <animated.div\n                              key={key}\n                              style={{\n                                ...props,\n                                position: \"relative\",\n                                width: \"100%\",\n                                height: \"100%\",\n                              }}\n                            >\n                              {page}\n                            </animated.div>\n                          );\n                        })}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n          </>\n        </>\n      )}\n    </Layout>\n  );\n};\nexport default PokemonDetailsPage;\n"]},"metadata":{},"sourceType":"module"}