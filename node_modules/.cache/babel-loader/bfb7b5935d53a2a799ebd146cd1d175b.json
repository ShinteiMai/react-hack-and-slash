{"ast":null,"code":"var _jsxFileName = \"/home/shinteimai/workspace/personal/react-pokedex/src/pages/PokemonsPage.tsx\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport PokemonForm from \"../components/PokemonForm\";\nimport Layout from \"../components/Layout\";\nimport InfiniteScroll from \"../components/InfiniteScroll\";\nimport PokemonCard from \"../components/PokemonCard\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { pokemonsSelector, getPokemonsReducer, PAGINATE_SIZE, initializePokemonsReducer } from \"../features/pokemonSlice\";\nimport { SliceStatus } from \"../globals\";\nimport { cachedPokemonsSelector } from \"../features/cachedPokemonsSlice\";\nimport PokemonSkeleton from \"../components/PokemonSkeleton\";\nimport fromApi from \"../api/fromApi\";\nimport { transformSpriteToBaseImage } from \"../features/utilities\";\nimport { baseImageUrl } from \"../api/axios\";\nimport { camelcaseObject } from \"../utils/camelcaseObject\";\n\nconst PokemonsPage = () => {\n  const pokemons = useSelector(pokemonsSelector);\n  const cachedPokemons = useSelector(cachedPokemonsSelector);\n  const dispatch = useDispatch();\n  const fetchPokemons = useCallback(async page => {\n    const size = PAGINATE_SIZE - pokemons.data.length % PAGINATE_SIZE;\n    dispatch(initializePokemonsReducer({\n      size\n    }));\n    return cachedPokemons.data.slice(page, page + size);\n  }, [cachedPokemons.data, pokemons.data, dispatch]);\n  const [isFetching, setIsFetching] = useState(!!pokemons.data.slice(Math.max(pokemons.data.length - PAGINATE_SIZE, 1)).find(pokemon => pokemon === null));\n  useEffect(() => {\n    setIsFetching(!!pokemons.data.slice(Math.max(pokemons.data.length - PAGINATE_SIZE, 1)).find(pokemon => pokemon === null));\n  }, [pokemons.data]);\n  return /*#__PURE__*/React.createElement(Layout, {\n    title: \"Home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"text-3xl lg:text-5xl font-semibold text-center sm:text-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, \"React Pok\\xE9dex\"), /*#__PURE__*/React.createElement(InfiniteScroll, {\n    isLoading: pokemons.status.state === SliceStatus.LOADING,\n    isFetching: isFetching,\n    paginationHandler: page => fetchPokemons(page),\n    paginationUpdater: async (index, size, {\n      url\n    }) => {\n      const pokemonId = Number(url.split(\"/\").slice(-2)[0]);\n      const pokemon = await fromApi.getPokemonByNameOrId(pokemonId);\n      const pokemonImageUrl = transformSpriteToBaseImage(pokemon.id, baseImageUrl);\n      dispatch(getPokemonsReducer({\n        pokemon: { ...camelcaseObject(pokemon),\n          sprites: {\n            frontDefault: pokemonImageUrl\n          }\n        },\n        size,\n        index\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, ({\n    mutatePage\n  }) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"my-4 md:my-6 lg:my-8 w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PokemonForm, {\n    placeholder: \"Search for a pok\\xE9mon...\",\n    mutatePage: mutatePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mx-auto w-full text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, !(cachedPokemons.status.state === SliceStatus.LOADING || cachedPokemons.status.state === SliceStatus.IDLE) && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(InfiniteScroll.Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 19\n    }\n  }, pokemons.data.map((pokemon, index) => pokemon === null ? /*#__PURE__*/React.createElement(\"div\", {\n    key: `loading-${index}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(PokemonSkeleton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 27\n    }\n  })) : /*#__PURE__*/React.createElement(PokemonCard, Object.assign({\n    key: pokemon.id\n  }, pokemon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(InfiniteScroll.Waypoint, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 19\n    }\n  }))))));\n};\n\nexport default PokemonsPage;","map":{"version":3,"sources":["/home/shinteimai/workspace/personal/react-pokedex/src/pages/PokemonsPage.tsx"],"names":["React","useCallback","useEffect","useState","PokemonForm","Layout","InfiniteScroll","PokemonCard","useDispatch","useSelector","pokemonsSelector","getPokemonsReducer","PAGINATE_SIZE","initializePokemonsReducer","SliceStatus","cachedPokemonsSelector","PokemonSkeleton","fromApi","transformSpriteToBaseImage","baseImageUrl","camelcaseObject","PokemonsPage","pokemons","cachedPokemons","dispatch","fetchPokemons","page","size","data","length","slice","isFetching","setIsFetching","Math","max","find","pokemon","status","state","LOADING","index","url","pokemonId","Number","split","getPokemonByNameOrId","pokemonImageUrl","id","sprites","frontDefault","mutatePage","IDLE","map"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport PokemonForm from \"../components/PokemonForm\";\n\nimport Layout from \"../components/Layout\";\nimport InfiniteScroll from \"../components/InfiniteScroll\";\nimport PokemonCard from \"../components/PokemonCard\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  pokemonsSelector,\n  getPokemonsReducer,\n  PAGINATE_SIZE,\n  initializePokemonsReducer,\n} from \"../features/pokemonSlice\";\nimport { SliceStatus } from \"../globals\";\nimport { cachedPokemonsSelector } from \"../features/cachedPokemonsSlice\";\nimport PokemonSkeleton from \"../components/PokemonSkeleton\";\nimport fromApi from \"../api/fromApi\";\nimport { transformSpriteToBaseImage } from \"../features/utilities\";\nimport { baseImageUrl } from \"../api/axios\";\nimport { camelcaseObject } from \"../utils/camelcaseObject\";\nimport { NamedAPIResource } from \"../features/types\";\n\nconst PokemonsPage = () => {\n  const pokemons = useSelector(pokemonsSelector);\n  const cachedPokemons = useSelector(cachedPokemonsSelector);\n  const dispatch = useDispatch();\n\n  const fetchPokemons = useCallback(\n    async (page: number) => {\n      const size = PAGINATE_SIZE - (pokemons.data.length % PAGINATE_SIZE);\n      dispatch(initializePokemonsReducer({ size }));\n      return cachedPokemons.data.slice(page, page + size);\n    },\n    [cachedPokemons.data, pokemons.data, dispatch]\n  );\n\n  const [isFetching, setIsFetching] = useState<boolean>(\n    !!pokemons.data\n      .slice(Math.max(pokemons.data.length - PAGINATE_SIZE, 1))\n      .find((pokemon) => pokemon === null)\n  );\n\n  useEffect(() => {\n    setIsFetching(\n      !!pokemons.data\n        .slice(Math.max(pokemons.data.length - PAGINATE_SIZE, 1))\n        .find((pokemon) => pokemon === null)\n    );\n  }, [pokemons.data]);\n\n  return (\n    <Layout title=\"Home\">\n      <h1 className=\"text-3xl lg:text-5xl font-semibold text-center sm:text-left\">\n        React Pokédex\n      </h1>\n\n      <InfiniteScroll\n        isLoading={pokemons.status.state === SliceStatus.LOADING}\n        isFetching={isFetching}\n        paginationHandler={(page: number) => fetchPokemons(page)}\n        paginationUpdater={async (\n          index: number,\n          size: number,\n          { url }: NamedAPIResource\n        ) => {\n          const pokemonId = Number(url.split(\"/\").slice(-2)[0]);\n          const pokemon = await fromApi.getPokemonByNameOrId(pokemonId);\n          const pokemonImageUrl = transformSpriteToBaseImage(\n            pokemon.id,\n            baseImageUrl\n          );\n\n          dispatch(\n            getPokemonsReducer({\n              pokemon: {\n                ...camelcaseObject(pokemon),\n                sprites: {\n                  frontDefault: pokemonImageUrl,\n                },\n              },\n              size,\n              index,\n            })\n          );\n        }}\n      >\n        {({ mutatePage }) => (\n          <>\n            <div className=\"my-4 md:my-6 lg:my-8 w-full\">\n              <PokemonForm\n                placeholder=\"Search for a pokémon...\"\n                mutatePage={mutatePage}\n              />\n            </div>\n            <div className=\"mx-auto w-full text-center\">\n              {!(\n                cachedPokemons.status.state === SliceStatus.LOADING ||\n                cachedPokemons.status.state === SliceStatus.IDLE\n              ) && (\n                <>\n                  <InfiniteScroll.Container>\n                    {pokemons.data.map((pokemon, index) =>\n                      pokemon === null ? (\n                        <div key={`loading-${index}`}>\n                          <PokemonSkeleton />\n                        </div>\n                      ) : (\n                        <PokemonCard key={pokemon.id} {...pokemon} />\n                      )\n                    )}\n                  </InfiniteScroll.Container>\n                  <InfiniteScroll.Waypoint />\n                </>\n              )}\n            </div>\n          </>\n        )}\n      </InfiniteScroll>\n    </Layout>\n  );\n};\nexport default PokemonsPage;\n"]},"metadata":{},"sourceType":"module"}